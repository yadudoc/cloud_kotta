

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Deploying Cloud Kotta &mdash; Cloud Kotta beta documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Cloud Kotta beta documentation" href="../index.html"/>
        <link rel="next" title="License" href="license.html"/>
        <link rel="prev" title="Contributing" href="contributing.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Cloud Kotta
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userguide/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/kotta_access.html">Cloud Kotta Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/kottabooks.html">Kotta Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/data_management.html">Data Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/submitting_jobs.html">Submitting Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/publishing.html">Publishing Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/bastion_access.html">Bastion Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userguide/cli.html">Commandline Client for Cloud Kotta</a></li>
</ul>
<p class="caption"><span class="caption-text">Kotta Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../kotta_lib/kottalibrary.html">Kotta Library</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Deploying Cloud Kotta</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#launching-cloudformation">1. Launching CloudFormation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launching-kotta-base">2. Launching Kotta-Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-changes-to-your-kotta-stack">3. Custom Changes to your Kotta Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="#set-region">1. Set Region</a></li>
<li class="toctree-l2"><a class="reference internal" href="#register-a-domain">2. Register a Domain</a></li>
<li class="toctree-l2"><a class="reference internal" href="#login-with-amazon">3. Login with Amazon</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-certificate">4. Create a certificate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launch-the-base">5. Launch the Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launch-kotta">6. Launch Kotta</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>
<p class="caption"><span class="caption-text">Dataset Catalog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dataguide/wos.html">Web Of Science (WoS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataguide/wiki.html">Wikipedia</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataguide/aura.html">UChicago AURA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataguide/ieee.html">IEEE full text</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataguide/jstor.html">JSTOR ngrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataguide/pubmed.html">Medline</a></li>
</ul>
<p class="caption"><span class="caption-text">WoS Hackathon</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../wos_hack/howto.html">WoS Hackathon</a></li>
</ul>
<p class="caption"><span class="caption-text">Contact</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Administrators</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Cloud Kotta</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Deploying Cloud Kotta</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/devguide/deployment.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="deploying-cloud-kotta">
<h1>Deploying Cloud Kotta<a class="headerlink" href="#deploying-cloud-kotta" title="Permalink to this headline">¶</a></h1>
<p>Cloud Kotta infrastructure and code are both Open Source and designed to be reproducible.
The infrastructure is written as a json configuration file using Amazon&#8217;s CloudFormation, and the various services that run on the infrastructure is written in python. All of this is available on the <a class="reference external" href="https://github.com/yadudoc/cloud_kotta">github page</a>. This docs page will cover the steps to deploy an instance of Cloud Kotta.</p>
<div class="section" id="launching-cloudformation">
<h2>1. Launching CloudFormation<a class="headerlink" href="#launching-cloudformation" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Git clone the <a class="reference external" href="https://github.com/yadudoc/cloud_kotta">cloud_kotta</a> repo.</li>
<li>Make sure you have admin privileges on AWS</li>
<li>Go to <a class="reference external" href="https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/new">cloudformation console for launch stack</a></li>
<li>Select <em>Upload a template to Amazon S3</em> and select the <strong>Cloud_Kotta_Base.json</strong> file from cloud_kotta/infrastructure/Cloud_Kotta_Base.json and click <strong>Next</strong></li>
<li>Name the stack, and specify a short and sweet name for the JobsBucket. Please note that the name of the bucket specified
should match the S3 naming conventions and also be globally unique.</li>
<li>Click <strong>Next</strong> to launch.</li>
</ol>
<p>7. Once the stack has been launched without errors, check the outputs from the outputs tab in the CloudFormation console
to see details of the various services that have been launched.</p>
</div>
<div class="section" id="launching-kotta-base">
<h2>2. Launching Kotta-Base<a class="headerlink" href="#launching-kotta-base" title="Permalink to this headline">¶</a></h2>
<p>The Kotta launch process starts with launching the Kotta base cloudformation document. This cloudformation
document launches the persistent data-stores and the roles that will be necessary by the main kotta setup.</p>
<p>This setup will launch the following :</p>
<ol class="arabic simple">
<li><strong>JobsBucket</strong>  : This is the S3 bucket designated for storing uploads, outputs generated, and the code store
for deploying private repos. All custom changes to the kotta system codebase will be stored on this bucket</li>
</ol>
<p>for deployment.</p>
<ol class="arabic simple" start="2">
<li><strong>JobsTable</strong>  : This is the DynamoDB table that holds all the job information. Several Kotta stacks can
be served from a single tables without losing any history.</li>
<li><strong>UsersTable</strong> : This is the DynamoDB table that holds all the user information. This needs to be manually
popoluated for a fresh kotta setup.</li>
</ol>
<p>4. <strong>Roles</strong> : The kotta base cloudformation document will also setup the appropriate roles for the WebServer
and the TaskExecutor.</p>
<ol class="arabic simple" start="5">
<li><strong>Policies</strong> : Access policies for the above roles to the JobsBucket are also created.</li>
</ol>
</div>
<div class="section" id="custom-changes-to-your-kotta-stack">
<h2>3. Custom Changes to your Kotta Stack<a class="headerlink" href="#custom-changes-to-your-kotta-stack" title="Permalink to this headline">¶</a></h2>
<p>In order to make custom changes to the stack, git clone the cloud_kotta repo and make appropriate
changes to cloud_kotta/web2 directory. Update the production.conf and the pages under cloud_kotta/web2/views.</p>
<p>Once changes have been made, tar ball the directory.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>git clone https://github.com/yadudoc/cloud_kotta.git
<span class="c1"># Make changes to cloud_kotta/web2 configs and web views.</span>
             ....
<span class="c1"># Make the tarball</span>
tar -cvzf cloud_kotta.tar.gz cloud_kotta

<span class="c1"># Upload to JobsBucket.</span>
aws s3 cp cloud_kotta.tar.gz s3://&lt;Your_Jobs_Bucket_Name&gt;/code/
</pre></div>
</div>
</div>
<div class="section" id="set-region">
<h2>1. Set Region<a class="headerlink" href="#set-region" title="Permalink to this headline">¶</a></h2>
<p>Please ensure that all your tests are done in the AWS North Virginia Region. This is required to ensure that the AMI&#8217;s used in the cloudformation documents are valid and available. With more testing and usage, the cloudformation document will support other regions and/or potentially multiple regions but that is a capability this system currently lacks.</p>
<p>Steps to change region on Web Console :</p>
<ol class="arabic simple">
<li>Login to your AWS web console</li>
<li>The regions are listed in a dropdown on the top right corner.</li>
<li>Select N.Virginia from the dropdown</li>
</ol>
<p>Alternatively, load this URL which specifies the region, us-east-1 which represents N.Virginia
after logging into the web console: <a class="reference external" href="https://console.aws.amazon.com/console/home?region=us-east-1#">https://console.aws.amazon.com/console/home?region=us-east-1#</a></p>
<p>To read more : <a class="reference external" href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html">AWS Regions and availability zones</a></p>
</div>
<div class="section" id="register-a-domain">
<h2>2. Register a Domain<a class="headerlink" href="#register-a-domain" title="Permalink to this headline">¶</a></h2>
<p>It is nice to have a domain registered and use that with the next step. To setup a domain name the simplest solution is to use Amazon&#8217;s Route 53 service.
This also allows the creation of a HTTPS SSL cert using the AWS certificat manager that could be used to provide HTTPS access to the web interface.</p>
<p>Here&#8217;s documentation on how to register a domain : <a class="reference external" href="http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-register.html">http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-register.html</a></p>
</div>
<div class="section" id="login-with-amazon">
<h2>3. Login with Amazon<a class="headerlink" href="#login-with-amazon" title="Permalink to this headline">¶</a></h2>
<p>Cloud Kotta relies on Amazon&#8217;s OAuth2 implementation, Login with Amazon for handling user authentication.</p>
<p>Follow steps here: <a class="reference external" href="http://login.amazon.com/website">Register Documentation</a></p>
<p>As you finish the registration process, ensure that you note down the Client-ID and secret</p>
</div>
<div class="section" id="create-a-certificate">
<h2>4. Create a certificate<a class="headerlink" href="#create-a-certificate" title="Permalink to this headline">¶</a></h2>
<p>The Amazon certificate manager allows you to create certificates for your domain that can be used with Elastic Load Balancers.
Go to <a class="reference external" href="https://console.aws.amazon.com/acm/home?region=us-east-1#/">https://console.aws.amazon.com/acm/home?region=us-east-1#/</a> and follow steps outlined here to get a certificate:
<a class="reference external" href="https://aws.amazon.com/certificate-manager/getting-started/">https://aws.amazon.com/certificate-manager/getting-started/</a>. This is a fairly simple process as the request certificate button
takes you to a wizard. In this step you create are requesting a managed certificate used by web browsers to verify the authenticity
of your website with a 3rd party (AWS in this case).</p>
<p>Once a certificate is generated, get the ARN for the certificate. This is to be passed to the Cloud formation form during the Cloud Kotta deployment phase.
This certifate is a managed SSL certificate used to terminate SSL connections at the Elastic Load Balancer. This allows us to have SSL from the user to the
network, and plain HTTP from the Load balancer to the Webserver.</p>
</div>
<div class="section" id="launch-the-base">
<h2>5. Launch the Base<a class="headerlink" href="#launch-the-base" title="Permalink to this headline">¶</a></h2>
<p>Kotta base setup creates the following :</p>
<ol class="arabic simple">
<li>Jobs DB : The database that holds the jobs information</li>
<li>Users DB : A database that holds user information</li>
<li>WebServer Role : Web server role with the appropriate permissions</li>
<li>Worker Role : Worker role with appropriate perms</li>
<li>Jobs Bucket : The default bucket where job data, uploads etc are stored</li>
</ol>
</div>
<div class="section" id="launch-kotta">
<h2>6. Launch Kotta<a class="headerlink" href="#launch-kotta" title="Permalink to this headline">¶</a></h2>
<p>Launch the Kotta cloudformation document.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="license.html" class="btn btn-neutral float-right" title="License" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="contributing.html" class="btn btn-neutral" title="Contributing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Knowledge Lab, University of Chicago.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'beta',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>